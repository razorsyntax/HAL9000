<!DOCTYPE html>
<html>

<head>
	<!--<script type="text/javascript" src="src/HAL9000.js"></script>-->
	<script type="text/javascript" src="src/HAL9000.min.js"></script>

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.2.1/math.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.2.2/Chart.bundle.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.2.2/Chart.min.js"></script>

</head>

<body style="background-color:#151515;color:#bfbfbf;font-family:sans-serif;margin-left:40px;">
	<div>
		<div><h3 style="margin-left:15px;">HAL9000 training demo</h3></div>
		<div><h4 style="margin-left:30px;">Hal is learning to identity the given input [0,0,1]</h4></div>
		<div>
			<div style="max-width:750px;max-height:450px;background-color: #f1f1f1;margin-bottom: 15px;border-radius: 3px;">
				<canvas id="myChart" width="750" height="450"></canvas>
			</div>
			<div id="NN"></div>
			<div id="error"></div>
			<div id="output"></div>
			<div id="Hal"></div>
		</div>
		<div style="margin-top:15px;"><a href="https://github.com/razorsyntax/HAL9000" style="color:#4343f3">GitHub</a></div>
	</div>
</body>
<script>
		var globalOutputArr;
		var globalError = [];
		var globalFinalError = [];
		var testInputs = [0,0,1];
		//var testInputs = [.05,.10];
		var ctx = document.getElementById("myChart");
		

		(function(){
			//          TESTING REGION          \\
			/***********************************/
			//Setting up an MNIST Neural Network


			//creates instance of NN obj
			var NN = new NeuralNetwork("Hal9000");

			//layer attributes with automatic neuron generation
			var layerAttributes = {
				"name": "HiddenLayer",
				"type": "hidden",
				"neurons": NeuronArray(3, "logsig")
			};
			//create n hidden neurons with activation attributes
			NN.createLayer(layerAttributes);

			//layer attributes with automatic neuron generation
			var layerAttributes1 = {
				"name": "HiddenLayer",
				"type": "hidden",
				"neurons": NeuronArray(3, "logsig")
			};
			//create n hidden neurons with activation attributes
			NN.createLayer(layerAttributes1);

			//layer attributes with automatic neuron generation
			var layerAttributes2 = {
				"name": "HiddenLayer",
				"type": "hidden",
				"neurons": NeuronArray(3, "logsig")
			};
			//create n hidden neurons with activation attributes
			NN.createLayer(layerAttributes2);

			//create output layer and give it attributes
			NN.createLayer({
				"name": "MNIST",
				"type": "output",
				"neurons": NeuronArray(3, "logsig")
			});

			//set target array
			//var targetArr = testInputs;
			//var targetArr = [.01,.99];
			//var targetArr = [0,1];
			var targetArr = [0,0,1];
			NN.setTarget(targetArr);
			
			//set input array
			var inputs = testInputs;
			//var inputs = [0,1];

			//Initialize inputs
			//this step creates a JSON obj with all initial weights and biases in NN
    		NN.init(inputs); 

			//learning rate
			var rate = 0.5;

			//Testing ONLY
			var count = [];
			var includeData = []
			//Train NN with provided inputs
			for(let i=0;i<10000;i++){
				Train(NN, inputs, rate);

				var rate = 0.5;
				var inputs = testInputs;
				//var inputs = [0,1];
				if (i%100 === 0){
					count.push(i);
					if(globalError[i] < 0.01) {
						includeData.push(globalError[i]);
					}
				}
				
			}
			window.NN = NN;
			console.log("Error: " + globalFinalError + "\n");
			console.log("Actual output: " + globalOutputArr + "\n");
			var rounded = [];
			for(let i=0;i<globalOutputArr.length;i++){
				rounded.push(Math.round(globalOutputArr[i]));
			}
			$("#Hal").append("<div>Error: " + globalFinalError + "<p>Actual output: " + globalOutputArr + "<p/>HAL9000 thinks your input is: [" + rounded + "]</div>");
			console.log("HAL9000 thinks your input is: [" + rounded + "]\n");
			var chartAttributes = {
		    	type: 'line',
		    	data: {
					labels: count,
					datasets: [
						{
							label: "Training Error",
							fill: false,
							lineTension: 0.1,
							backgroundColor: "rgba(75,192,192,0.4)",
            				borderColor: "rgba(75,192,192,1)",
            				borderCapStyle: 'butt',
            				borderDash: [],
            				borderDashOffset: 0.0,
            				borderJoinStyle: 'miter',
            				pointBorderColor: "rgba(75,192,192,1)",
            				pointBackgroundColor: "#fff",
            				pointBorderWidth: 1,
            				pointHoverRadius: 5,
            				pointHoverBackgroundColor: "rgba(75,192,192,1)",
            				pointHoverBorderColor: "rgba(220,220,220,1)",
            				pointHoverBorderWidth: 2,
            				pointRadius: 1,
            				pointHitRadius: 10,
            				data: includeData,
            				spanGaps: true,
						}
					]
				},
 		   		options: {scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:false
                }
            }]
        }}
			};

			
			var myChart = new Chart(ctx, chartAttributes);

			/***********************************/

		}).call(this);

		$(".choose").on('click', function(){
			
		})
	</script>

</html>
